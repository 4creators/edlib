<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.12"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>Edlib: Edlib</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">Edlib 1.0.0.</a>
                    <a class="navbar-brand" href="http://github.com/Martinsos/edlib">
                        (github.com/Martinsos/edlib)
                    </a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Edlib </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://github.com/Martinsos/edlib/releases/latest"></a> <a href="https://travis-ci.org/Martinsos/edlib"></a> <a href="https://ci.appveyor.com/project/Martinsos/edlib/branch/master"></a> <a href="https://gitter.im/Martinsos/edlib"></a> <a href="https://doi.org/10.1093/bioinformatics/btw753"></a></p>
<p>A lightweight and super fast C/C++ library for sequence alignment using <a href="https://en.wikipedia.org/wiki/Edit_distance">edit distance</a>.</p>
<p>Calculating edit distance of two strings is as simple as: </p><div class="fragment"><div class="line"><a class="code" href="edlib_8h.html#ae263bc878b6837c5ec36a3b25dc854d6">edlibAlign</a>(<span class="stringliteral">&quot;hello&quot;</span>, 5, <span class="stringliteral">&quot;world!&quot;</span>, 6, <a class="code" href="edlib_8h.html#a046b587c7774537ea7fb9bdce72a30b3">edlibDefaultAlignConfig</a>()).<a class="code" href="structEdlibAlignResult.html#a71c9753152dff85e94261c783a6d3b6d">editDistance</a>;</div></div><!-- fragment --><h3>Features</h3>
<ul>
<li>Calculates <b>edit distance (Levehnstein distance)</b>.</li>
<li>It can find <b>optimal alignment path</b> (instructions how to transform first sequence into the second sequence).</li>
<li>It can find just the <b>start and/or end locations of alignment path</b> - can be useful when speed is more important than having exact alignment path.</li>
<li>Supports <b>multiple <a href="#align-methods">alignment methods</a></b>: global(<b>NW</b>), prefix(<b>SHW</b>) and infix(<b>HW</b>), each of them useful for different scenarios.</li>
<li>It can easily handle small or <b>very large</b> sequences, even when finding alignment path, while consuming very little memory.</li>
<li><b>Super fast</b> thanks to Myers's bit-vector algorithm.</li>
</ul>
<p>Edlib is also available for <b>Python</b> <a href="https://pypi.python.org/pypi/edlib"></a> and <b>Node.js</b> <a href="https://www.npmjs.com/package/node-edlib"></a>.</p>
<h2><a class="anchor" id="building"></a>Building</h2>
<p>Edlib uses CMAKE to build libraries (static and shared) and binaries (apps and tests). Execute following commands to build Edlib using CMAKE:</p>
<ol type="1">
<li><code>cd build</code></li>
<li><code>cmake -D CMAKE_BUILD_TYPE=Release ..</code></li>
<li><code>make</code></li>
</ol>
<p>This will create binaries in <code>bin/</code> directory and libraries (static and shared) in <code>lib/</code> directory. You can run <code>./bin/runTests</code> to confirm that it works!</p>
<p>Optionally, you can run <code>sudo make install</code> to install edlib library on your machine (on Linux, this will usually install it to <code>usr/local/lib</code> and <code>usr/local/include</code>).</p>
<p>You may also install edlib using Conda <a href="https://conda.anaconda.org/bioconda"></a>: <code>conda install edlib</code>.</p>
<h2>Using Edlib in your project</h2>
<p>You can use Edlib in you project by either directly copying header and source files from <a href="edlib/">edlib/</a>, or by linking Edlib library (see <a href="#building">Building</a> for instructions how to build Edlib libraries). In any case, only thing that you have to do in your source files is to include <code><a class="el" href="edlib_8h.html" title="Main header file, containing all public functions and structures. ">edlib.h</a></code>.</p>
<p>To get you started quickly, let's take a look at a few ways to get simple Hello World project working.</p>
<p>Our Hello World project has just one source file, helloWorld.c file, and it looks like this: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="edlib_8h.html">edlib.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main() {</div><div class="line">    <a class="code" href="structEdlibAlignResult.html">EdlibAlignResult</a> result = <a class="code" href="edlib_8h.html#ae263bc878b6837c5ec36a3b25dc854d6">edlibAlign</a>(<span class="stringliteral">&quot;hello&quot;</span>, 5, <span class="stringliteral">&quot;world!&quot;</span>, 6, <a class="code" href="edlib_8h.html#a046b587c7774537ea7fb9bdce72a30b3">edlibDefaultAlignConfig</a>());</div><div class="line">    printf(<span class="stringliteral">&quot;edit_distance(&#39;hello&#39;, &#39;world!&#39;) = %d\n&quot;</span>, result.<a class="code" href="structEdlibAlignResult.html#a71c9753152dff85e94261c783a6d3b6d">editDistance</a>);</div><div class="line">    <a class="code" href="edlib_8h.html#a5c40e385ff6bd8a72b70840a2780e3a9">edlibFreeAlignResult</a>(result);</div><div class="line">}</div></div><!-- fragment --><p>Running it should output `edit_distance('hello', 'world!') = 5`.</p>
<h3>Approach #1: Directly copying edlib source and header files.</h3>
<p>Here we directly copied <a href="edlib/">edlib/</a> directory to our project, to get following project structure: </p><div class="fragment"><div class="line">edlib/  -&gt; copied from edlib/</div><div class="line">  include/</div><div class="line">    edlib.h</div><div class="line">  src/</div><div class="line">    edlib.cpp</div><div class="line">helloWorld.c -&gt; your program</div></div><!-- fragment --><p>Compile it with <code>g++ helloWorld.c edlib/src/edlib.cpp -o helloWorld -I edlib/include</code> and that is it!</p>
<h3>Approach #2: Copying edlib header file and static library.</h3>
<p>Instead of copying edlib source files, you could copy static library (check <a href="#building">Building</a> on how to create static library). We also need to copy edlib header files. We get following project structure: </p><div class="fragment"><div class="line">edlib/  -&gt; copied from edlib</div><div class="line">  include/</div><div class="line">    edlib.h</div><div class="line">  edlib.a</div><div class="line">helloWorld.c -&gt; your program</div></div><!-- fragment --><p>Now you can compile it with <code>g++ helloWorld.c -o helloWorld -I edlib/include -L edlib -ledlib_static</code>.</p>
<h3>Approach #3: Install edlib library on machine.</h3>
<p>Alternatively, you could avoid copying any Edlib files and instead install libraries by running <code>sudo make install</code> (check <a href="#building">Building</a>). Now, all you have to do to compile your project is <code>g++ helloWorld.c -o helloWorld -ledlib</code>. If you get error message like <code>cannot open shared object file: No such file or directory</code>, make sure that your linker includes path where edlib was installed.</p>
<p>For more example projects take a look at applications in <a href="apps/">apps/</a>.</p>
<h2>Usage and examples</h2>
<p>Main function in edlib is <code>edlibAlign</code>. Given two sequences (and their lengths), it will find edit distance, alignment path or its end and start locations.</p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span>* query = <span class="stringliteral">&quot;ACCTCTG&quot;</span>;</div><div class="line"><span class="keywordtype">char</span>* target = <span class="stringliteral">&quot;ACTCTGAAA&quot;</span></div><div class="line"><a class="code" href="structEdlibAlignResult.html">EdlibAlignResult</a> result = <a class="code" href="edlib_8h.html#ae263bc878b6837c5ec36a3b25dc854d6">edlibAlign</a>(query, 7, target, 9, <a class="code" href="edlib_8h.html#a046b587c7774537ea7fb9bdce72a30b3">edlibDefaultAlignConfig</a>());</div><div class="line">printf(<span class="stringliteral">&quot;%d&quot;</span>, result.<a class="code" href="structEdlibAlignResult.html#a71c9753152dff85e94261c783a6d3b6d">editDistance</a>);</div><div class="line"><a class="code" href="edlib_8h.html#a5c40e385ff6bd8a72b70840a2780e3a9">edlibFreeAlignResult</a>(result);</div></div><!-- fragment --><h3>Configuring <a class="el" href="edlib_8h.html#ae263bc878b6837c5ec36a3b25dc854d6">edlibAlign()</a></h3>
<p><code>edlibAlign</code> takes configuration object (it is a struct <code><a class="el" href="structEdlibAlignConfig.html" title="Configuration object for edlibAlign() function. ">EdlibAlignConfig</a></code>), which allows you to further customize how alignment will be done. You can choose <a href="#align-methods">alignment method</a>, tell edlib what to calculate (just edit distance or also path and locations) and set upper limit for edit distance.</p>
<p>For example, if you want to use infix(HW) alignment method, want to find alignment path (and edit distance), and are interested in result only if edit distance is not larger than 42, you would call it like this: </p><div class="fragment"><div class="line"><a class="code" href="edlib_8h.html#ae263bc878b6837c5ec36a3b25dc854d6">edlibAlign</a>(seq1, seq1Length, seq2, seq2Length,</div><div class="line">           <a class="code" href="edlib_8h.html#a72f08f1e82de2fce260bb50c84357088">edlibNewAlignConfig</a>(42, <a class="code" href="edlib_8h.html#a1b87679bc3340cac59e53dd80a65a54aa467420e364536a0d01ca8a3423c857e2">EDLIB_MODE_HW</a>, <a class="code" href="edlib_8h.html#ac61632355a338b20a3aa4235ef0c7473ac9803220a42d9ca8ae1eab9a7c83bf1e">EDLIB_TASK_PATH</a>));</div></div><!-- fragment --><p> Or, if you want to use suffix(SHW) alignment method, want to find only edit distance, and do not have any limits on edit distance, you would call it like this: </p><div class="fragment"><div class="line"><a class="code" href="edlib_8h.html#ae263bc878b6837c5ec36a3b25dc854d6">edlibAlign</a>(seq1, seq1Length, seq2, seq2Length,</div><div class="line">           <a class="code" href="edlib_8h.html#a72f08f1e82de2fce260bb50c84357088">edlibNewAlignConfig</a>(-1, <a class="code" href="edlib_8h.html#a1b87679bc3340cac59e53dd80a65a54aaf97d5fa1a2ff934fea55464cf1009957">EDLIB_MODE_SHW</a>, <a class="code" href="edlib_8h.html#ac61632355a338b20a3aa4235ef0c7473abe3f5a2c18768f6af69997e32c111e6f">EDLIB_TASK_DISTANCE</a>));</div></div><!-- fragment --><p>We used <code>edlibNewAlignConfig</code> helper function to easily create config, however we could have also just created an instance of it and set its members accordingly.</p>
<h3>Handling result of <a class="el" href="edlib_8h.html#ae263bc878b6837c5ec36a3b25dc854d6">edlibAlign()</a></h3>
<p><code>edlibAlign</code> function returns a result object (<code><a class="el" href="structEdlibAlignResult.html">EdlibAlignResult</a></code>), which will contain results of alignment (corresponding to the task that you passed in config).</p>
<div class="fragment"><div class="line"><a class="code" href="structEdlibAlignResult.html">EdlibAlignResult</a> result = <a class="code" href="edlib_8h.html#ae263bc878b6837c5ec36a3b25dc854d6">edlibAlign</a>(seq1, seq1Length, seq2, seq2Length,</div><div class="line">                                     <a class="code" href="edlib_8h.html#a72f08f1e82de2fce260bb50c84357088">edlibNewAlignConfig</a>(-1, <a class="code" href="edlib_8h.html#a1b87679bc3340cac59e53dd80a65a54aa467420e364536a0d01ca8a3423c857e2">EDLIB_MODE_HW</a>, <a class="code" href="edlib_8h.html#ac61632355a338b20a3aa4235ef0c7473ac9803220a42d9ca8ae1eab9a7c83bf1e">EDLIB_TASK_PATH</a>));</div><div class="line">printf(<span class="stringliteral">&quot;%d\n&quot;</span>, result.<a class="code" href="structEdlibAlignResult.html#a71c9753152dff85e94261c783a6d3b6d">editDistance</a>);</div><div class="line">printf(<span class="stringliteral">&quot;%d\n&quot;</span>, result.<a class="code" href="structEdlibAlignResult.html#acec901640eaf09d640370bbe8e00c66e">alignmentLength</a>);</div><div class="line">printf(<span class="stringliteral">&quot;%d\n&quot;</span>, result.<a class="code" href="structEdlibAlignResult.html#a08130305f96bc8f4707fabb04e465a52">endLocations</a>[0]);</div><div class="line"><a class="code" href="edlib_8h.html#a5c40e385ff6bd8a72b70840a2780e3a9">edlibFreeAlignResult</a>(result);</div></div><!-- fragment --><p>It is important to remember to free the result object using <code>edlibFreeAlignResult</code> function, since Edlib allocates memory on heap for certain members. If you decide to do the cleaning manually and not use <code>edlibFreeAlignResult</code>, do not forget to manually <code>free()</code> required members.</p>
<h3>Turning alignment to cigar</h3>
<p>Cigar is a standard way to represent alignment path. Edlib has helper function that transforms alignment path into cigar. </p><div class="fragment"><div class="line"><span class="keywordtype">char</span>* cigar = <a class="code" href="edlib_8h.html#a84310235e0d36e19fda12351269e888c">edlibAlignmentToCigar</a>(result.<a class="code" href="structEdlibAlignResult.html#ab77e0fe1de5cb3be7e11e33e484befda">alignment</a>, result.<a class="code" href="structEdlibAlignResult.html#acec901640eaf09d640370bbe8e00c66e">alignmentLength</a>, <a class="code" href="edlib_8h.html#a7187b0c5024ce4073ab94e1d4af59458a3b174e40c045b057c599c01acffee9fe">EDLIB_CIGAR_STANDARD</a>);</div><div class="line">printf(<span class="stringliteral">&quot;%s&quot;</span>, cigar);</div><div class="line">free(cigar);</div></div><!-- fragment --><h2>API documentation</h2>
<p>For complete documentation of Edlib library API, visit <a href="https://martinsos.github.io/edlib">http://martinsos.github.io/edlib</a> (should be updated to the latest release).</p>
<p>To generate the latest API documentation yourself from the source, you need to have <a href="www.doxygen.org">doxygen</a> installed. Position yourself in the root directory and run <code>doxygen</code>, this will generate <code>docs/</code> directory. Then open <code>docs/html/index.html</code> file with you favorite browser.</p>
<h2><a class="anchor" id="align-methods"></a>Alignment methods</h2>
<p>Edlib supports 3 alignment methods:</p><ul>
<li><b>global (NW)</b> - This is the standard method, when we say "edit distance" this is the method that is assumed. It tells us the smallest number of operations needed to transform first sequence into second sequence. <em>This method is appropriate when you want to find out how similar is first sequence to second sequence.</em></li>
<li><b>prefix (SHW)</b> - Similar to global method, but with a small twist - gap at query end is not penalized. What that means is that deleting elements from the end of second sequence is "free"! For example, if we had <code>AACT</code> and <code>AACTGGC</code>, edit distance would be 0, because removing <code>GGC</code> from the end of second sequence is "free" and does not count into total edit distance. <em>This method is appropriate when you want to find out how well first sequence fits at the beginning of second sequence.</em></li>
<li><b>infix (HW)</b>: Similar as prefix method, but with one more twist - gaps at query end <b>and start</b> are not penalized. What that means is that deleting elements from the start and end of second sequence is "free"! For example, if we had <code>ACT</code> and <code>CGACTGAC</code>, edit distance would be 0, because removing <code>CG</code> from the start and <code>GAC</code> from the end of second sequence is "free" and does not count into total edit distance. <em>This method is appropriate when you want to find out how well first sequence fits at any part of second sequence.</em> For example, if your second sequence was a long text and your first sequence was a sentence from that text, but slightly scrambled, you could use this method to discover how scrambled it is and where it fits in that text. <em>In bioinformatics, this method is appropriate for aligning read to a sequence.</em></li>
</ul>
<h2>Aligner</h2>
<p>Edlib comes with a standalone aligner cli app, which can be found at <a href="apps/aligner">apps/aligner/</a>.</p>
<p>Aligner reads sequences from fasta files, and it can display alignment path in graphical manner or as a cigar. It also measures calculation time, so it can be useful for testing speed and comparing Edlib with other tools.</p>
<p>Check <a href="#building">Building</a> to see how to build binaries (including <code>edlib-aligner</code>). Run <code>./build/bin/edlib-aligner</code> with no params for help and detailed instructions.</p>
<p>Example of usage: <code>./build/bin/edlib-aligner -p apps/aligner/test_data/query.fasta apps/aligner/test_data/target.fasta</code></p>
<p><b>NOTE</b>: Aligner currently does not work on Windows, because it uses <code>getopt</code> to parse command line arguments, which is not supported on Windows.</p>
<h2>Running tests</h2>
<p>Check <a href="#building">Building</a> to see how to build binaries (including binary <code>runTests</code>). To run tests, just run <code>./runTests</code>. This will run random tests for each alignment method, and also some specific unit tests.</p>
<h2>Time and space complexity</h2>
<p>Edlib is based on <a href="http://www.gersteinlab.org/courses/452/09-spring/pdf/Myers.pdf">Myers's bit-vector algorithm</a> and extends from it. It calculates a dynamic programming matrix of dimensions <code>Q x T</code>, where <code>Q</code> is the length of the first sequence (query), and <code>T</code> is the length of the second sequence (target). It uses Ukkonen's banded algorithm to reduce the space of search, and there is also parallelization from Myers's algorithm, however time complexity is still quadratic. Edlib uses Hirschberg's algorithm to find alignment path, therefore space complexity is linear.</p>
<p>Time complexity: <code>O(T * Q)</code>.</p>
<p>Space complexity: <code>O(T + Q)</code>.</p>
<p>It is worth noting that Edlib works best for large, similar sequences, since such sequences get the highest speedup from banded approach and bit-vector parallelization.</p>
<h2>Test data</h2>
<p>In [test_data/](test_data) directory there are different genome sequences, ranging from 10 kbp to 5 Mbp in length. They are ranging in length and similarity, so they can be useful for testing and measuring speed in different scenarios.</p>
<h2>Development and contributing</h2>
<p>Feel free to send pull requests and raise issues.</p>
<p>When developing, you may want to use <code>-D CMAKE_BUILD_TYPE=Debug</code> flag when calling <code>cmake</code> in order to get debugging flags passed to compiler. This should also happen if you just run <code>cmake ..</code> with no flags, but I think I have noticed it does not always works as expected (probably has something to do with cmake cache). To check which flags is compiler using, run <code>make</code> with <code>VERBOSE=1</code>: <code>make VERBOSE=1</code>.</p>
<h2>Publication</h2>
<p>Martin Šošić, Mile Šikić; Edlib: a C/C ++ library for fast, exact sequence alignment using edit distance. Bioinformatics 2017 btw753. doi: <a href="https://doi.org/10.1093/bioinformatics/btw753">10.1093/bioinformatics/btw753</a></p>
<h2>Acknowledgements</h2>
<p>Mile Šikić () - Mentoring and guidance through whole project.</p>
<p>Ivan Sović () - Help with testing and prioritizing features, valuable comments on the manuscript. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
